---
lab:
  title: 在 Azure AI Studio 中针对聊天补全微调语言模型
---

# 在 Azure AI Studio 中针对聊天补全微调语言模型

在本练习中，你将使用要用于自定义 Copilot 方案的 Azure AI Studio 微调语言模型。

该练习大约需要 **45** 分钟。

## 在 Azure AI Studio 中创建 AI 中心和项目

首先，在 Azure AI 中心内创建 Azure AI Studio 项目：

1. 在 Web 浏览器中，使用 Azure 凭据打开 [https://ai.azure.com](https://ai.azure.com) 并登录。
1. 选择“开始”页，然后选择“+ 新建项目”。********
1. 在“创建新项目”向导中，使用以下设置创建项目****：
    - 项目名称****：项目的唯一名称**
    - **中心**：*使用以下设置创建新中心：*
        - **中心名称**：唯一的名称**
        - **订阅**：Azure 订阅
        - 资源组****：新资源组**
        - 位置****：从以下任何区域中进行随机选择******\*
        - 美国东部 2
        - 美国中北部
        - 瑞典中部
        - 瑞士北部
    - **连接 Azure AI 服务或 Azure OpenAI**：*创建新连接*
    - **连接 Azure AI 搜索**：跳过连接

    > \* Azure OpenAI 资源受区域配额限制在租户级别。 列出的区域包括本练习中使用的模型类型的默认配额。 随机选择区域可降低单个区域达到其配额限制的风险。 如果稍后在练习中达到配额限制，你可能需要在不同的区域中创建另一个资源。 详细了解 [每个区域的模型可用性](https://learn.microsoft.com/en-us/azure/ai-studio/concepts/fine-tuning-overview#azure-openai-models)

1. 查看配置并创建项目。
1. 等待创建项目。

## 微调 GPT-3.5 模型

微调模型之前，需要一个数据集。

1. 在本地将训练数据集另存为 JSONL 文件：https://raw.githubusercontent.com/MicrosoftLearning/mslearn-ai-studio/main/data/travel-finetune.jsonl
1. 使用左侧菜单导航到“**工具**”部分下的“**微调**”页。
1. 选择该按钮以添加新的微调模型，选择该 `gpt-35-turbo` 模型，然后选择“**确认**”。
1. 使用以下配置**微调**该模型：
    - **模型版本**：*选择默认版本*
    - **模型后缀**：`ft-travel`
    - **Azure OpenAI 连接**：*选择创建中心时创建的连接*
    - **训练数据**：上传文件
    - **上传文件**：选择在上一步骤中下载的 JSONL 文件。

    > **提示**：无需等待数据处理完成，即可继续执行下一步。

    - **验证数据**：无
    - **任务参数**：*保留默认设置*
1. 微调将开始，可能需要一些时间才能完成。

> **备注**：微调和部署可能需要一些时间，因此可能需要定期回查才能完成下一步。

## 部署微调后模型

成功完成微调后，即可部署模型。

1. 选择微调后模型。 选择“**指标**”选项卡并浏览微调指标。
1. 使用以下配置部署微调后模型：
    - **部署名称**：*模型的唯一名称，可以使用默认值*
    - **部署类型**：标准
    - **每分钟令牌数速率限制（数千个）**：5K
    - **内容筛选器**：默认

## 测试微调后模型

部署微调模型后，可以像测试任何其他已部署的模型一样测试模型。

1. 部署准备就绪后，导航到微调后模型并选择“**在操场中打开**”。
1. 在聊天窗口中，输入查询 `What can you do?`，请注意，即使未指定系统消息来指示模型回答与旅行相关的问题，该模型也已经理解它应该关注的内容。
1. 尝试使用其他查询，例如 `Where should I go on holiday for my 30th birthday?`

## 清理

如果已完成对 Azure AI Studio 的探索，应删除已创建的资源，以避免产生不必要的 Azure 成本。

- 导航到 Azure 门户，地址为 `https://portal.azure.com`[](https://portal.azure.com)。
- 在 Azure 门户的**主页**上，选择“资源组”。
- 选择你为本练习创建的资源组。
- 在资源组的“概述”页的顶部，选择“删除资源组”。
- 输入资源组名称以确认要删除该资源组，然后选择“删除”。
